\documentclass[10pt]{article}

\usepackage{amsthm}
\usepackage[toc,page]{appendix}
\usepackage{amssymb}
\usepackage{pslatex,palatino,avant,graphicx,color}
\usepackage{colortbl}
\usepackage{fullpage}
\usepackage{mathtools}
\usepackage{natbib}
\usepackage{amsmath}
\usepackage{caption}
%\usepackage{subfigure}
\usepackage{subcaption}
\usepackage{bm}
\usepackage{wrapfig}
\usepackage{enumerate}
\usepackage{rotating}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{bbm}
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents

\newtheorem{lemma}{Lemma}
%\pdfminorversion=4
% NOTE: To produce blinded version, replace "0" with "1" below.
\newcommand{\blind}{0}

% DON'T change margins - should be 1 inch all around.
\addtolength{\oddsidemargin}{0in}%
\addtolength{\evensidemargin}{0in}%
\addtolength{\textwidth}{0in}%
\addtolength{\textheight}{0in}%
\addtolength{\topmargin}{0in}%


\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

\newcommand{\indicator}[1]{\mathbbm{1}\left( #1 \right) }
\newcommand{\hb}{\hat{b}}
\newcommand{\ha}{\hat{a}}
\newcommand{\htheta}{\hat{\theta}}
\newcommand{\halpha}{\hat{\alpha}}
\newcommand{\hmu}{\hat{\mu}}
\newcommand{\hsigma}{\hat{\sigma}}
\newcommand{\hphi}{\hat{\phi}}
\newcommand{\htau}{\hat{\tau}}
\newcommand{\heta}{\hat{\eta}}
\newcommand{\E}[1]{\mbox{E}\left[#1\right]}
\newcommand{\Var}[1]{\mbox{Var}\left[#1\right]}
\newcommand{\Indicator}[1]{\mathbbm{1}_{ \left( #1 \right) } }
\newcommand{\dNormal}[3]{ N\left( #1 \left| #2, #3 \right. \right) }
\newcommand{\Beta}[2]{\mbox{Beta}\left( #1, #2 \right)}
\newcommand{\alphaphi}{\alpha_{\hphi}}
\newcommand{\betaphi}{\beta_{\hphi}}
\newcommand{\expo}[1]{ \exp\left\{ #1 \right\}}
\newcommand{\tauSquareDelta}{\htau^2
  \left(\frac{1-\expo{-2\htheta\Delta}}{2\htheta} \right)}
\newcommand{\mumu}{\mu_{\hmu}}
\newcommand{\sigmamu}{\sigma^2_{\hmu}}
\newcommand{\sigmamuexpr}{\log\left( \frac{\VarX}{\EX^2} + 1 \right)}
\newcommand{\mumuexpr}{\log(\EX) -  \log\left( \frac{\VarX}{\EX^2} + 1 \right) /2 }

\newcommand{\EX}{\mbox{E}\left[ X \right] }
\newcommand{\VarX}{\mbox{Var}\left[ X \right] }
\newcommand{\mueta}{\mu_{\heta} }
\newcommand{\sigmaeta}{\sigma^2_{\heta}}
\newcommand{\sigmaetaexpr}{ \log\left( \frac{\VarX}{\EX^2} + 1 \right) }
\newcommand{\muetaexpr}{ \log(\EX) -  \sigmaetaexpr /2 }

\newcommand{\mualpha}{\mu_{\halpha} }
\newcommand{\sigmaalpha}{\sigma^2_{\halpha}}
\newcommand{\sigmaalphaexpr}{ \log\left( \frac{\VarX}{\EX^2} + 1 \right) }
\newcommand{\mualphaexpr}{ \log(\EX) -  \sigmaalphaexpr /2 }

\newcommand{\mutauexpr}{ \frac{2}{T} \EX }
\newcommand{\sigmatauexpr}{ \frac{4}{T^2} \Var{X}}

\newcommand{\alphatau}{\alpha_{\htau^2}}
\newcommand{\betatau}{\beta_{\htau^2}}

\newcommand{\Gam}[2]{\mbox{Gamma}\left( #1, #2 \right) }
\newcommand{\InvGam}[2]{\mbox{Inv-Gamma}\left( #1, #2 \right) }

%%% END Article customizations

%%% The "real" document content comes below...

% \newbox{\LegendeA}
% \savebox{\LegendeA}{
%    (\begin{pspicture}(0,0)(0.6,0)
%    \psline[linewidth=0.04,linecolor=red](0,0.1)(0.6,0.1)
%    \end{pspicture})}
% \newbox{\LegendeB}
%    \savebox{\LegendeB}{
%    (\begin{pspicture}(0,0)(0.6,0)
%    \psline[linestyle=dashed,dash=1pt 2pt,linewidth=0.04,linecolor=blue](0,0.1)(0.6,0.1)
%    \end{pspicture})}

\title{Solution to a Non-Seperable Diffusion Equation on a Regular Domain}
\author{Georgi Dinolov, Abel Rodriguez, Hongyun Wang}
\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\def\spacingset#1{\renewcommand{\baselinestretch}%
{#1}\small\normalsize} \spacingset{1}

\bigskip

\vspace{1cm}
\noindent

\spacingset{1.00} % 
\section{Introduction}

We consider two-dimensional correlated Brownian motion with absorbing boundaries:
\begin{align}
  X(t) &= x_0 + \mu_x t + \sigma_x W_x(t) &a_x &< X(t) < b_x   \label{eq:X} \\
  Y(t) &= y_0 + \mu_y t + \sigma_y W_y(t) &a_y &< Y(t) < b_y   \label{eq:Y} 
\end{align}
where $W_i$ are standard Brownian motions with
$\mbox{Cov}(W_1(t), W_2(t)) = \rho t$ for $0 < t' \leq t$. In
particular, we find the joint transition density function for
$(X(t), Y(t))$ under the boundary conditions:
\begin{align}
  p\left(X(t) = x, Y(t) = y | a_x < X(t') < b_x, a_y < Y(t') < b_y, 0 < t' \leq t, X(0)=x_0, Y(0)=y_0 \right). \label{eq:CDF}
\end{align}
This density, which we shorten to $p(x,y,t)$ from now on, is the
solution to the Fokker-Planck equation \citep{oksendal2013stochastic}:
\begin{align}
  \frac{\partial}{\partial t} p(x,y,t') &= -\mu_x \frac{\partial}{\partial x}p(x,y,t')
                                         - \mu_y \frac{\partial}{\partial y}p(x,y,t')
                                         + \frac{1}{2}\sigma_x^2 \frac{\partial^2}{\partial x^2}p(x,y,t')
                                         + \rho\sigma_x\sigma_y \frac{\partial^2}{\partial x \partial y}p(x,y,t')
                                         + \frac{1}{2}\sigma_y^2 \frac{\partial^2}{\partial y^2}p(x,y,t'),
  \label{eq:1} \\
  p(a_x, y,t') &= p(b_x,y,t') = p(x,a_y,t') = p(x,b_y,t') = 0, \label{eq:2} \\
   0 &< t' \leq t. \nonumber
\end{align}
Differentiating $p(x,y,t)$ with respect to the boundaries produces the
transition density of a particle beginning and ending at the points
$(X_1(0), X_2(0))$ and $(X_1(t), X_2(t))$ respectively, while
attaining the minima $a_x/a_y$ and maxima $b_x/b_y$ in each coordinate
direction:
\begin{align*}
  \frac{\partial^4}{\partial a_x \partial b_x \partial a_y \partial
  b_y} p(x,y,t) = 
\end{align*}
\begin{align}
  p\left(X(t) = x, Y(t) = y \left| \min_{t'}X(t') = a_x,
  \max_{t'}X(t')=b_x, \min_{t'} Y(t')=a_y, \max_{t'} Y(t')=b_y, 0 <
  t' \leq t, X(0)=x_0, Y(0)=y_0 \right.\right). \label{eq:pdf}
\end{align}

The transition density for the considered system has been used in
computing first passage times \citep{kou2016first,
  sacerdote2016first}, with application to structural models in credit
risk and default correlations \citep{haworth2008modelling,
  ching2014correlated}. \cite{he1998double} use variants of the
differentiated solutions with respect to some of the boundaries to
price financial derivative instruments whose payoff depends on
observed maxima/minima. 

Closed-form solutions to (\ref{eq:1}) - (\ref{eq:2}) are available for
some parameter regimes. When $\rho = 0$, the transition density of the
process can be obtained with a Fourier expansion. When $a_1 = -\infty$
and $b_1 = \infty$, the method of images can be used to enforce the
remaining boundaries. For either $a_1, a_2 = -\infty$ or
$b_1, b_2 = \infty$, the Fokker-Plank equation is a Sturm-Liouville
problem in radial coordinates. Both of these techniques are used by
\cite{he1998double}. However, to the best of our knowledge, there is
no closed-form solution to the general problem in (\ref{eq:1}) -
(\ref{eq:2}).

It is still possible to approach the general problem by proposing a
Fourier expansions. However, a drawback of this out-of-the-box
solution is that the system matrix for the corresponding eigenvalue
problem is large and dense. An alternative is to use a finite
difference scheme. However, discretization of the initial condition
introduces a numerical bias in the estimation procedure.

In this paper, we propose a solution to the general problem
(\ref{eq:1}) - (\ref{eq:2}) which is obtained by combining a
small-time analytic solution with a finite-element method. Our
application is the maximal likelihood estimation

ADD OUT APPLICATION (ESTIMATION)

\section{Approximate Numerical Solutions}
Before considering any solutions to (\ref{eq:1}) - (\ref{eq:2}), we
simplify the PDE in (\ref{eq:1}) by using the fact that parameters
$(\mu_x, \mu_y, \sigma_x, \sigma_y, \rho)$ are constant and solving
for the exponential decomposition
\[
  p(x,y,t) = \exp(\alpha x + \beta y + \gamma t) q(x,y,t).
\]
We can find $\alpha, \beta$ and $\gamma$, as well as a scaling
transformation, such that $q(x,y,t)$ satisfies
\begin{align}
  \frac{\partial}{\partial t} q(x,y,t') &= \frac{1}{2}\sigma_x^2
  \frac{\partial^2}{\partial x^2}q(x,y,t') + \rho\sigma_x\sigma_y
  \frac{\partial^2}{\partial x \partial y}q(x,y,t') +
  \frac{1}{2}\sigma_y^2 \frac{\partial^2}{\partial y^2}q(x,y,t').
                                          \label{eq:qq} \\
  q(x,y,t) &=0 &\mbox{for } & (x,y) \in \partial \Omega \nonumber \\
  q(x,y,0) &= \delta(x-x_0) \delta(y-y_0) \nonumber
\end{align}
on the unit square.  We will consider the solution to this PDE without
loss of generality.


\subsection{Fourier Expansion}
The formal Fourier (sinusoidal) expansion for the problem is given by
\begin{align*}
  q(x,y,t) &= \lim_{K,L\to\infty}\sum_{k=1}^K \sum_{l=1}^L c_{k,l}(t) \sin\left(2\pi\cdot k \frac{x-a_x}{b_x-a_x}\right) \sin\left(2\pi\cdot l \frac{y-a_y}{b_y-a_y}\right) \\
  \hat{q}(x,y,t) &= \sum_{k=1}^K \sum_{l=1}^L c_{k,l}(t) \sin\left(2\pi\cdot k \frac{x-a_x}{b_x-a_x}\right) \sin\left(2\pi\cdot l \frac{y-a_y}{b_y-a_y}\right) & \mbox{for some } K, L
\end{align*}
With $\rho = 0$, the sinusoidal functions are the eigenvectors for the
differential operator in (\ref{eq:qq}), and we would proceed by
substituting $\hat{q}$ into (\ref{eq:qq}) and deriving a system of
ODEs whose solution is the vector $(c_{1,1}(t), \ldots,
c_{K,L}(t))$. In this case the system matrix is diagonal so that each
$c_{k,l}(t)$ can be written down analytically.

We can proceed in the same manner in the case where $\rho \neq
0$. However, the mixing terms
\[
  \frac{\partial^2}{\partial x \partial y} \sin\left(2\pi\cdot k
    \frac{x-a_x}{b_x-a_x}\right) \sin\left(2\pi\cdot l
    \frac{y-a_y}{b_y-a_y}\right),
\]
are cosines and as such have a non-sparse representation in terms of
sine series. Because of this, the matrix for the system of ODEs when
$\rho \neq 0$ is dense. Moreover, the truncation values for $K$ and
$L$ are also large. Finally, to compute 
\subsection{Finite Difference}


\subsection{Finite Element Method}
The method we use relies on two pieces:
\begin{enumerate}
\item a small-time analytic solution $q(x,y,t_\epsilon)$ for the IC/BC problem,
\item a family of orthonormal basis functions which represent
  $q(x,y,t_\epsilon)$ parsimoniously.
\end{enumerate}
By combining 1) and 2), we can efficiently find a weak solution to the
PDE (\ref{eq:qq}) via the finite element method
\citep{shaidurov2013multigrid}. Convergence of our method to the
strong solution under the $L^2(\bar{\Omega})$ norm is guaranteed as
long as the family we propose is complete in the Banach space of
functions induced under $L^2(\bar{\Omega})$.

The small-time solution is derived by considering the fundamental
solution $G(x,y |t, x_0, y_0)$ for the unbounded problem in
(\ref{eq:qq}), which is the bivariate Gaussian density with mean and
covariance determined by the initial condition and the diffusion
parameters \citep{stakgold2011green}. We can then find a small enough
$t_\epsilon$ such that $G(x,y|t_\epsilon,x_0, y_0)$ is numerically
zero on three of the four boundaries of $\bar{\Omega}$. The
zero-condition on the remaining boundary is enforced by suitably
reflecting $G(x,y|t_\epsilon,x_0, y_0)$ about the boundary. The
small-time solution therefore takes on the analytic form
\[
  q(x,y,t_\epsilon) = G(x,y|t_\epsilon,x_0, y_0) - G(x,y|t_\epsilon,x'_0, y'_0),
\]
for some known $(x'_0, y'_0, t_\epsilon)$.

The construction of the orthonormal basis functions is motivated by
the Green's function for the unbounded problem: before performing
Gram-Schmidt orthogonalization, the finite family of basis functions
are of the form
\[
  \tilde{\psi}_k(x,y| x_k, y_k, \rho, \sigma) = N\left( (x,y)^T \left|
      (x_k, y_k)^T , \quad \left( \begin{array}{cc}
                                     \sigma^2 & \rho \sigma^2 \\
                                     \rho \sigma^2 & \sigma^2
                     \end{array} \right) \right. \right) x(1-x)y(1-y).
\]
The advantage of these basis elements is that they better resolve the
fundamental for the unbounded problem by taking into account $\rho$ in
the covariance of each kernel. By performing Gram-Schmidt
orthogonalization under the $L^2(\Omega)$ norm, we arrive at a family
of orthonormal functions which can better resolve small-time solutions
having a large correlation coefficient.

% \subsection{Small-time Analytic Solution}
% The fundamental solution for the heat problem in (\ref{eq:qq})
% \textit{without the boundary conditions} is the bivariate Gaussian
% density function
% \begin{align}
%   G(x,y,t | x_0, y_0) &= N\left( (x,y)^T \left| (x_0, y_0)^T , \quad
%              t\left( \begin{array}{cc}
%                        \sigma_x^2 & \rho \sigma_x \sigma_y \\
%                        \rho \sigma_x \sigma_y & \sigma_y^2
%                      \end{array} \right) \right. \right).         
% \end{align}
% For a fixed $(x_0,y_0)$, we can find a small time $t_\epsilon$
% solution to the PDE where three of the four boundaries are enforced
% numerically (maximum value of numerical solution is $\sim 10^{-16}$,
% while the last boundary condition is enforced by reflecting $G(x,y,t)$
% accross it. This small-time solution is analytic, satisfying both the
% differential operator as well as the IC/BC. Let this small-time solution be denoted as
% \[
%   q(x,y,t_\epsilon).
% \]

% \subsection{Finite Element Method}
% We use the small-time solution as an initial condition in a finite
% element scheme to find the weak solution to (\ref{eq:qq}). To do so,
% we need to choose a suitable family of basis functions. Apart from
% satisfying the boundary conditions, there are many choices available
% for basis functions. The out-of-the-box solution is usually linear
% interpolants on either triangular or rectangular meshes
% \citep{shaidurov2013multigrid} over the computational
% domain. However, such an approach ignores the correlation structure
% of the solution to (\ref{eq:qq}).

% For this reason, we propose a family of basis functions which do
% take into account the correlation.

\begin{lemma}
  The maximum likelihood estimator is consistent as $n \to \infty$ and $k \to \infty$:
  \[ \hat{\theta}_{n,k} \to \theta \].
\end{lemma}
\begin{proof}
  By the definition of weak convergence, given the weak solution $q_k$
  and the classical solution $q$, for any continuous function $f$,
  \[ \langle q_k| f \rangle \to \langle q| f \rangle \mbox { as } k \to \infty. \]

  Because $f$ can be any function in $L^2$, we can choose $f$ to be
  $\exp(ilx)$ for any integer $l$. This means that the characteristic
  function of $X_k$ converges pointwise to the characteristic function
  of $X$. By Levy's continuity theorem, this means that
  \[ X_k \xrightarrow[]{d} X \mbox { as } k \to \infty. \]

  Next, given Theorem 4.1 in \cite{singler2008differentiability}, we
  know that, for each $k$, $q_k$ satisfies the criteria in
  \cite{casella2002statistical} to guarantee that, for data
  $X_{k} \sim F_k(\theta)$,
  \[ \hat{\theta}_{n,k}(X_k) \xrightarrow[]{p} \theta \] as $n \to
  \infty$. In other words, the MLE estimator for
  $(\sigma_x, \sigma_y, \rho)$ based on the likelihood function under
  $F_k$ for data sampled from $F_k$. Now we need to show that the same
  holds for data sampled from $F$ as $k \to \infty$.

  To do this, we will use Chebyshev's inequality:
  \begin{align*}
    \Pr_{X}\left( \left| \hat{\theta}_{n,k}(X_k) - \theta \right| \geq \epsilon \right) &\leq \frac{ \mbox{E}_{X}\left[ (\hat{\theta}_{n,k}(X_k) - \theta)^2 \right] }{ \epsilon^2 }.
  \end{align*}
  By the Maximum theorem, $\hat{\theta}_{n,k}(x)$ is a continuous
  function with respect to $x$, meaning that 
\end{proof}


\bibliographystyle{plainnat}
\bibliography{master-bibliography}
\end{document}
