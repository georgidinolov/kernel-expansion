\documentclass[10pt]{article}


\usepackage[toc,page]{appendix}
\usepackage{amssymb}
\usepackage{pslatex,palatino,avant,graphicx,color}
\usepackage{colortbl}
\usepackage{fullpage}
\usepackage{mathtools}
\usepackage{natbib}
\usepackage{amsmath}
\usepackage{caption}
%\usepackage{subfigure}
\usepackage{subcaption}
\usepackage{bm}
\usepackage{wrapfig}
\usepackage{enumerate}
\usepackage{rotating}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{bbm}
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents

%\pdfminorversion=4
% NOTE: To produce blinded version, replace "0" with "1" below.
\newcommand{\blind}{0}

% DON'T change margins - should be 1 inch all around.
\addtolength{\oddsidemargin}{0in}%
\addtolength{\evensidemargin}{0in}%
\addtolength{\textwidth}{0in}%
\addtolength{\textheight}{0in}%
\addtolength{\topmargin}{0in}%


\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

\newcommand{\indicator}[1]{\mathbbm{1}\left( #1 \right) }
\newcommand{\hb}{\hat{b}}
\newcommand{\ha}{\hat{a}}
\newcommand{\htheta}{\hat{\theta}}
\newcommand{\halpha}{\hat{\alpha}}
\newcommand{\hmu}{\hat{\mu}}
\newcommand{\hsigma}{\hat{\sigma}}
\newcommand{\hphi}{\hat{\phi}}
\newcommand{\htau}{\hat{\tau}}
\newcommand{\heta}{\hat{\eta}}
\newcommand{\E}[1]{\mbox{E}\left[#1\right]}
\newcommand{\Var}[1]{\mbox{Var}\left[#1\right]}
\newcommand{\Indicator}[1]{\mathbbm{1}_{ \left( #1 \right) } }
\newcommand{\dNormal}[3]{ N\left( #1 \left| #2, #3 \right. \right) }
\newcommand{\Beta}[2]{\mbox{Beta}\left( #1, #2 \right)}
\newcommand{\alphaphi}{\alpha_{\hphi}}
\newcommand{\betaphi}{\beta_{\hphi}}
\newcommand{\expo}[1]{ \exp\left\{ #1 \right\}}
\newcommand{\tauSquareDelta}{\htau^2
  \left(\frac{1-\expo{-2\htheta\Delta}}{2\htheta} \right)}
\newcommand{\mumu}{\mu_{\hmu}}
\newcommand{\sigmamu}{\sigma^2_{\hmu}}
\newcommand{\sigmamuexpr}{\log\left( \frac{\VarX}{\EX^2} + 1 \right)}
\newcommand{\mumuexpr}{\log(\EX) -  \log\left( \frac{\VarX}{\EX^2} + 1 \right) /2 }

\newcommand{\EX}{\mbox{E}\left[ X \right] }
\newcommand{\VarX}{\mbox{Var}\left[ X \right] }
\newcommand{\mueta}{\mu_{\heta} }
\newcommand{\sigmaeta}{\sigma^2_{\heta}}
\newcommand{\sigmaetaexpr}{ \log\left( \frac{\VarX}{\EX^2} + 1 \right) }
\newcommand{\muetaexpr}{ \log(\EX) -  \sigmaetaexpr /2 }

\newcommand{\mualpha}{\mu_{\halpha} }
\newcommand{\sigmaalpha}{\sigma^2_{\halpha}}
\newcommand{\sigmaalphaexpr}{ \log\left( \frac{\VarX}{\EX^2} + 1 \right) }
\newcommand{\mualphaexpr}{ \log(\EX) -  \sigmaalphaexpr /2 }

\newcommand{\mutauexpr}{ \frac{2}{T} \EX }
\newcommand{\sigmatauexpr}{ \frac{4}{T^2} \Var{X}}

\newcommand{\alphatau}{\alpha_{\htau^2}}
\newcommand{\betatau}{\beta_{\htau^2}}

\newcommand{\Gam}[2]{\mbox{Gamma}\left( #1, #2 \right) }
\newcommand{\InvGam}[2]{\mbox{Inv-Gamma}\left( #1, #2 \right) }

%%% END Article customizations

%%% The "real" document content comes below...

% \newbox{\LegendeA}
% \savebox{\LegendeA}{
%    (\begin{pspicture}(0,0)(0.6,0)
%    \psline[linewidth=0.04,linecolor=red](0,0.1)(0.6,0.1)
%    \end{pspicture})}
% \newbox{\LegendeB}
%    \savebox{\LegendeB}{
%    (\begin{pspicture}(0,0)(0.6,0)
%    \psline[linestyle=dashed,dash=1pt 2pt,linewidth=0.04,linecolor=blue](0,0.1)(0.6,0.1)
%    \end{pspicture})}

\title{Solution to a Non-Seperable Diffusion Equation on a Regular Domain}
\author{Georgi Dinolov, Abel Rodriguez, Hongyun Wang}
\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\def\spacingset#1{\renewcommand{\baselinestretch}%
{#1}\small\normalsize} \spacingset{1}

\bigskip

\vspace{1cm}
\noindent

\spacingset{1.00} % 
\section{Introduction}

We consider two-dimensional correlated Brownian motion with absorbing boundaries:
\begin{align}
  X(t) &= x_0 + \mu_x t + \sigma_x W_x(t) &a_x &< X(t) < b_x   \label{eq:X} \\
  Y(t) &= y_0 + \mu_y t + \sigma_y W_y(t) &a_y &< Y(t) < b_y   \label{eq:Y} 
\end{align}
where $W_i$ are standard Brownian motions with
$\mbox{Cov}(W_1(t), W_2(t)) = \rho t$ for $0 < t' \leq t$. In
particular, we find the joint transition density function for
$(X(t), Y(t))$ under the boundary conditions:
\begin{align}
  p\left(X(t) = x, Y(t) = y | a_x < X(t') < b_x, a_y < Y(t') < b_y, 0 < t' \leq t, X(0)=x_0, Y(0)=y_0 \right). \label{eq:CDF}
\end{align}
This density, which we shorten to $p(x,y,t)$ from now on, is the
solution to the Fokker-Planck equation \citep{oksendal2013stochastic}:
\begin{align}
  \frac{\partial}{\partial t} p(x,y,t') &= -\mu_x \frac{\partial}{\partial x}p(x,y,t')
                                         - \mu_y \frac{\partial}{\partial y}p(x,y,t')
                                         + \frac{1}{2}\sigma_x^2 \frac{\partial^2}{\partial x^2}p(x,y,t')
                                         + \rho\sigma_x\sigma_y \frac{\partial^2}{\partial x \partial y}p(x,y,t')
                                         + \frac{1}{2}\sigma_y^2 \frac{\partial^2}{\partial y^2}p(x,y,t'),
  \label{eq:1} \\
  p(a_x, y,t') &= p(b_x,y,t') = p(x,a_y,t') = p(x,b_y,t') = 0, \label{eq:2} \\
   0 &< t' \leq t. \nonumber
\end{align}
Differentiating $p(x,y,t)$ with respect to the boundaries produces the
transition density of a particle beginning and ending at the points
$(X_1(0), X_2(0))$ and $(X_1(t), X_2(t))$ respectively, while
attaining the minima $a_x/a_y$ and maxima $b_x/b_y$ in each coordinate
direction:
\begin{align*}
  \frac{\partial^4}{\partial a_x \partial b_x \partial a_y \partial
  b_y} p(x,y,t) = 
\end{align*}
\begin{align}
  p\left(X(t) = x, Y(t) = y \left| \min_{t'}X(t') = a_x,
  \max_{t'}X(t')=b_x, \min_{t'} Y(t')=a_y, \max_{t'} Y(t')=b_y, 0 <
  t' \leq t, X(0)=x_0, Y(0)=y_0 \right.\right). \label{eq:pdf}
\end{align}

The transition density for the considered system has been used in
computing first passage times \citep{kou2016first,
  sacerdote2016first}, with application to structural models in credit
risk and default correlations \citep{haworth2008modelling,
  ching2014correlated}. \cite{he1998double} use variants of the
differentiated solutions with respect to some of the boundaries to
price financial derivative instruments whose payoff depends on
observed maxima/minima. 

Closed-form solutions to (\ref{eq:1}) - (\ref{eq:2}) are available for
some parameter regimes. When $\rho = 0$, the transition density of the
process can be obtained with a Fourier expansion. When $a_1 = -\infty$
and $b_1 = \infty$, the method of images can be used to enforce the
remaining boundaries. For either $a_1, a_2 = -\infty$ or
$b_1, b_2 = \infty$, the Fokker-Plank equation is a Sturm-Liouville
problem in radial coordinates. Both of these techniques are used by
\cite{he1998double}. However, to the best of our knowledge, there is
no closed-form solution to the general problem in (\ref{eq:1}) -
(\ref{eq:2}).

It is still possible to approach the general problem by proposing a
Fourier expansions. However, a drawback of this out-of-the-box
solution is that the system matrix for the corresponding eigenvalue
problem is large and dense. An alternative is to use a finite
difference scheme. However, discretization of the initial condition
introduces a numerical bias in the estimation procedure.

In this paper, we propose a solution to the general problem
(\ref{eq:1}) - (\ref{eq:2}) which is obtained by combining a
small-time analytic solution with a finite-element method. Our
application is the maximal likelihood estimation

ADD OUT APPLICATION (ESTIMATION)

\section{Approximate Numerical Solutions}
Before considering any solutions to (\ref{eq:1}) - (\ref{eq:2}), we
simplify the PDE in (\ref{eq:1}) by using the fact that parameters
$(\mu_x, \mu_y, \sigma_x, \sigma_y, \rho)$ are constant and solving
for the exponential decomposition
\[
  p(x,y,t) = \exp(\alpha x + \beta y + \gamma t) q(x,y,t).
\]
Plugging the above equation into (\ref{eq:1}) and setting the
advection terms for $q(x,y,t)$ to zero, we arrive at the PDE
\begin{equation}
  \frac{\partial}{\partial t} q(x,y,t') = \frac{1}{2}\sigma_x^2
  \frac{\partial^2}{\partial x^2}q(x,y,t') + \rho\sigma_x\sigma_y
  \frac{\partial^2}{\partial x \partial y}q(x,y,t') +
  \frac{1}{2}\sigma_y^2 \frac{\partial^2}{\partial y^2}q(x,y,t').
  \label{eq:qq}
\end{equation}
We will consider the solution to this PDE, as it encompasses the
original problem.

\subsection{Fourier Expansion}
The formal Fourier (sinusoidal) expansion for the problem is given by
\begin{align*}
  q(x,y,t) &= \lim_{K,L\to\infty}\sum_{k=1}^K \sum_{l=1}^L c_{k,l}(t) \sin\left(2\pi\cdot k \frac{x-a_x}{b_x-a_x}\right) \sin\left(2\pi\cdot l \frac{y-a_y}{b_y-a_y}\right) \\
  \hat{q}(x,y,t) &= \sum_{k=1}^K \sum_{l=1}^L c_{k,l}(t) \sin\left(2\pi\cdot k \frac{x-a_x}{b_x-a_x}\right) \sin\left(2\pi\cdot l \frac{y-a_y}{b_y-a_y}\right) & \mbox{for some } K, L
\end{align*}
With $\rho = 0$, the sinusoidal functions are the eigenvectors for the
differential operator in (\ref{eq:qq}), and we would proceed by
substituting $\hat{q}$ into (\ref{eq:qq}) and deriving a system of
ODEs whose solution is the vector $(c_{1,1}(t), \ldots,
c_{K,L}(t))$. In this case the system matrix is diagonal so that each
$c_{k,l}(t)$ can be written down analytically.

We can proceed in the same manner in the case where $\rho \neq
0$. However, the mixing terms
\[
  \frac{\partial^2}{\partial x \partial y} \sin\left(2\pi\cdot k
    \frac{x-a_x}{b_x-a_x}\right) \sin\left(2\pi\cdot l
    \frac{y-a_y}{b_y-a_y}\right),
\]
are cosines and as such have a non-sparse representation in terms of
sine series. Because of this, the matrix for the system of ODEs when
$\rho \neq 0$ is dense. Moreover, the truncation values for $K$ and
$L$ are also large. Finally, to compute 
\subsection{Finite Difference}


\subsection{Finite Element}


\bibliographystyle{plainnat}
\bibliography{master-bibliography}
\end{document}
